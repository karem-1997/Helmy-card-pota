<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helmy Card - Ø¨ÙˆØªØ§ Ø§Ù„ÙØ§Ø®Ø±</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap');
        
        :root {
            --primary: #00d2ff;
            --secondary: #3a7bd5;
            --bg: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.7);
            --accent-red: #ff4757;
            --success: #2ed573;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
            color: #f1f5f9;
            margin: 0;
            display: flex; align-items: center; justify-content: center;
            min-height: 100vh; padding: 15px;
        }

        .container {
            width: 100%; max-width: 450px;
            background: var(--card-bg); backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 30px;
            padding: 30px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .header h1 {
            text-align: center; font-weight: 800; font-size: 28px; margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .urgent-note {
            color: var(--accent-red); font-weight: 700; font-size: 14px;
            display: block; text-align: center; margin-bottom: 20px; animation: pulse 2s infinite;
        }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }

        .admin-display {
            background: rgba(0, 210, 255, 0.1); border: 1.5px dashed var(--primary);
            border-radius: 18px; padding: 15px; text-align: center; margin-bottom: 25px;
        }
        .admin-display b { font-size: 26px; display: block; letter-spacing: 3px; color: #fff; }

        label { display: block; margin-bottom: 8px; font-size: 14px; font-weight: 600; color: var(--primary); }
        input, select {
            width: 100%; background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 14px;
            padding: 14px; color: #fff; margin-bottom: 15px; box-sizing: border-box; font-size: 16px;
        }

        .sub-label { display: block; font-size: 11px; color: var(--accent-red); margin-top: -10px; margin-bottom: 15px; }

        .result-card { background: rgba(46, 213, 115, 0.1); padding: 15px; border-radius: 16px; text-align: center; margin-bottom: 20px; border: 1px solid rgba(46, 213, 115, 0.3); }
        .result-amount { font-size: 22px; font-weight: 800; color: var(--success); }

        .btn-submit {
            width: 100%; padding: 16px; background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none; border-radius: 16px; color: white; font-size: 18px; font-weight: 700; cursor: pointer; transition: 0.3s;
        }
        .btn-submit:disabled { background: #475569; cursor: not-allowed; }

        #successModal {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            z-index: 9999; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(10px);
        }
        .modal-card { 
            background: #fff; color: #1e293b; width: 100%; max-width: 400px; 
            padding: 25px; border-radius: 25px; text-align: center; 
        }
        .modal-body { background: #f8fafc; border-radius: 15px; padding: 15px; margin-top: 10px; }
        .modal-row { display: flex; justify-content: space-between; border-bottom: 1px dashed #e2e8f0; padding: 10px 0; font-size: 14px; }
        .modal-row:last-child { border-bottom: none; }
        .modal-row b { color: #000; }

        .footer { text-align: center; margin-top: 25px; }
        .support-link {
            display: inline-flex; align-items: center; background: #25d366;
            color: #fff; text-decoration: none; padding: 12px 25px; border-radius: 12px; font-weight: 700;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header"><h1>Helmy Card â€“ Ø¨ÙˆØªØ§</h1></div>
    <span class="urgent-note">ÙŠØ³ØªØºØ±Ù‚ ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ§Ø±Ø¬Øª ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ 24 Ø³Ø§Ø¹Ø©</span>
    <div class="admin-display"><b>888185</b><span>ID Ø³Ø­Ø¨ Ø¨ÙˆØªØ§ ğŸ‘†ğŸ‘†</span></div>

    <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</label>
    <select id="payment_method" onchange="calculate()">
        <option value="vodafone">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ (44.50)</option>
        <option value="orange">Ø£ÙˆØ±Ø§Ù†Ø¬ ÙƒØ§Ø´ (44.50)</option>
        <option value="etisalat">Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´ (44.50)</option>
        <option value="agent">ÙƒÙˆØ¯ Ø§Ù„ÙˆÙƒÙŠÙ„ Ù Ø§Ù„Ù…Ù†ØµÙ‡ (45.00)</option>
    </select>

    <label>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ø­Ø¨ Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±</label>
    <input type="number" id="usd_input" placeholder="0.00" step="0.01" oninput="calculate()">

    <label>Ø§Ù„Ø£ÙŠØ¯ÙŠ Ø§Ù„ÙŠ Ø³Ø­Ø¨Øª Ù…Ù†Ùˆ</label>
    <input type="text" id="uid_input" placeholder="Ø§Ø¯Ø®Ù„ ID Ø§Ù„Ø£ÙƒÙˆÙ†Øª">

    <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø© / ÙƒÙˆØ¯ Ø§Ù„ÙˆÙƒÙŠÙ„</label>
    <input type="text" id="wallet_input" placeholder="01xxxxxxxxx Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯">
    <span class="sub-label">Ø§Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± 010 ÙŠØªÙ… Ø®ØµÙ… Ø¹Ù…ÙˆÙ„Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</span>

    <label>Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
    <input type="text" id="agent_name" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„">

    <div class="result-card"><div class="result-amount" id="egp_display">0.00 Ø¬.Ù…</div></div>

    <button class="btn-submit" onclick="processWithdrawal()" id="btnText">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸš€</button>

    <div class="footer">
        <a href="https://wa.me/201211511517" class="support-link" target="_blank">ğŸ’¬ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</a>
    </div>
</div>

<div id="successModal">
    <div class="modal-card">
        <div style="font-size: 40px; color: #2ed573;">âœ…</div>
        <h2 style="margin: 5px 0;">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­</h2>
        <div class="modal-body" id="invoice-details"></div>
        <button onclick="location.reload()" style="width:100%; padding:14px; background:#0f172a; color:#fff; border:none; border-radius:15px; margin-top:15px; cursor:pointer; font-weight:700;">ØªÙ… Ø§Ù„Ø­ÙØ¸</button>
    </div>
</div>

<script>
    const DB_URLS = [
        "https://sheetdb.io/api/v1/ba4uuazm9ncy3",
        "https://sheetdb.io/api/v1/w00q17tpeju22?sheet=Ø¨ÙˆØªØ§",
        "https://sheetdb.io/api/v1/v8gs5rfhy1oae"
    ];

    function calculate() {
        const method = document.getElementById('payment_method').value;
        const rate = (method === 'agent') ? 45.00 : 44.50;
        const usd = parseFloat(document.getElementById('usd_input').value) || 0;
        const egp = (usd * rate).toFixed(2);
        document.getElementById('egp_display').innerText = egp + " Ø¬.Ù…";
        return { usd, egp, methodText: document.getElementById('payment_method').options[document.getElementById('payment_method').selectedIndex].text };
    }

    async function processWithdrawal() {
        const uid = document.getElementById('uid_input').value.trim();
        const wallet = document.getElementById('wallet_input').value.trim();
        const usdVal = document.getElementById('usd_input').value;
        const agent = document.getElementById('agent_name').value.trim() || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯";
        const btn = document.getElementById('btnText');

        if (!uid || !wallet || !usdVal) { alert("âš ï¸ Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©"); return; }

        btn.disabled = true;
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...";

        try {
            const fetchPromises = DB_URLS.map(url => fetch(url).then(res => res.json()));
            const results = await Promise.all(fetchPromises);
            const allRecords = results.flat();

            if (allRecords.some(row => String(row["Ø§Ù„Ø£ÙŠØ¯ÙŠ"]).trim() === uid)) {
                alert("âŒ Ù‡Ø°Ø§ Ø§Ù„Ø£ÙŠØ¯ÙŠ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª.");
                btn.disabled = false; btn.innerText = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸš€";
                return;
            }

            const { usd, egp, methodText } = calculate();
            const timestamp = new Date().toLocaleString('ar-EG');
            
            const payload = { data: [{ "Ø§Ù„Ø£ÙŠØ¯ÙŠ": uid, "Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±": usd + " $", "Ø§Ù„Ù…ØµØ±ÙŠ": egp + " Ø¬.Ù…", "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙØ¸Ø©": "'" + wallet, "Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„": agent, "Ø§Ù„ØªØ§Ø±ÙŠØ®": timestamp }] };

            // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„ÙŠÙƒÙˆÙ† Ù…Ø·Ø§Ø¨Ù‚Ø§Ù‹ Ù„Ù„ØµÙˆØ± Ø¨ØªØ¨Ø§Ø¹Ø¯ ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ©
            const telegramMsg = `ğŸ“¥ *Ø·Ù„Ø¨ Ø³Ø­Ø¨ Ø¨ÙˆØªØ§ Ø¬Ø¯ÙŠØ¯* ğŸ“¥

ğŸ‘¤ *Ø§Ù„Ø£ÙŠØ¯ÙŠ:* \`${uid}\`

ğŸ’µ *Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±:* ${usd} $

ğŸ‡ªğŸ‡¬ *Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ù…ØµØ±ÙŠ:* ${egp} Ø¬.Ù…

ğŸ’³ *Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:* ${methodText}

ğŸ“± *Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©:* \`${wallet}\`

ğŸ‘¤ *Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„:* ${agent}

â° *Ø§Ù„ØªÙˆÙ‚ÙŠØª:* ${timestamp}`;

            await Promise.all([
                ...DB_URLS.map(url => fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) })),
                fetch(`https://api.telegram.org/bot8476254137:AAHmKi2eJCBhAFv_IdE0J312NLAr17LZmQ0/sendMessage`, {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: "7054064246", text: telegramMsg, parse_mode: 'Markdown' })
                })
            ]);

            // Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            document.getElementById('invoice-details').innerHTML = `
                <div class="modal-row"><span>ğŸ‘¤ Ø§Ù„Ø£ÙŠØ¯ÙŠ:</span><b>${uid}</b></div>
                <div class="modal-row"><span>ğŸ’µ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±:</span><b>${usd} $</b></div>
                <div class="modal-row"><span>ğŸ‡ªğŸ‡¬ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ù…ØµØ±ÙŠ:</span><b style="color:#2ed573">${egp} Ø¬.Ù…</b></div>
                <div class="modal-row"><span>ğŸ“± Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©:</span><b>${wallet}</b></div>
                <div class="modal-row"><span>ğŸ’³ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©:</span><b>${methodText}</b></div>
                <div class="modal-row"><span>ğŸ‘¤ Ø§Ù„ÙˆÙƒÙŠÙ„:</span><b>${agent}</b></div>
                <div class="modal-row"><span>â° Ø§Ù„ØªÙˆÙ‚ÙŠØª:</span><b>${timestamp}</b></div>
            `;
            document.getElementById('successModal').style.display = 'flex';

        } catch (e) {
            alert("âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
            btn.disabled = false; btn.innerText = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸš€";
        }
    }
</script>
</body>
</html>
